//! Emoji picker widget

use egui::{Color32, Vec2};

/// Common emoji categories
pub const EMOJI_CATEGORIES: &[(&str, &str, &[&str])] = &[
    ("üòÄ", "Smileys", &["üòÄ", "üòÉ", "üòÑ", "üòÅ", "üòÜ", "üòÖ", "ü§£", "üòÇ", "üôÇ", "üôÉ", "üòâ", "üòä", "üòá", "ü•∞", "üòç", "ü§©", "üòò", "üòó", "üòö", "üòô", "ü•≤", "üòã", "üòõ", "üòú", "ü§™", "üòù", "ü§ë", "ü§ó", "ü§≠", "ü§´", "ü§î", "ü§ê", "ü§®", "üòê", "üòë", "üò∂", "üòè", "üòí", "üôÑ", "üò¨", "üòÆ‚Äçüí®", "ü§•"]),
    ("üëç", "Gestures", &["üëç", "üëé", "üëä", "‚úä", "ü§õ", "ü§ú", "üëè", "üôå", "üëê", "ü§≤", "ü§ù", "üôè", "‚úåÔ∏è", "ü§û", "ü§ü", "ü§ò", "ü§ô", "üëà", "üëâ", "üëÜ", "üñï", "üëá", "‚òùÔ∏è", "üëã", "ü§ö", "üñêÔ∏è", "‚úã", "üññ", "üëå", "ü§å", "ü§è", "‚úçÔ∏è", "ü§≥", "üí™"]),
    ("‚ù§Ô∏è", "Hearts", &["‚ù§Ô∏è", "üß°", "üíõ", "üíö", "üíô", "üíú", "üñ§", "ü§ç", "ü§é", "üíî", "‚ù£Ô∏è", "üíï", "üíû", "üíì", "üíó", "üíñ", "üíò", "üíù", "üíü"]),
    ("üéâ", "Celebration", &["üéâ", "üéä", "üéà", "üéÅ", "üéÄ", "ü™Ö", "ü™Ñ", "üéÇ", "üç∞", "üßÅ", "ü•≥", "ü•Ç", "üçæ", "‚ú®", "üåü", "‚≠ê", "üèÜ", "ü•á", "üéñÔ∏è", "üèÖ"]),
    ("üë§", "People", &["üë∂", "üëß", "üßí", "üë¶", "üë©", "üßë", "üë®", "üë©‚Äçü¶±", "üßë‚Äçü¶±", "üë®‚Äçü¶±", "üë©‚Äçü¶∞", "üßë‚Äçü¶∞", "üë®‚Äçü¶∞", "üë±‚Äç‚ôÄÔ∏è", "üë±", "üë±‚Äç‚ôÇÔ∏è", "üë©‚Äçü¶≥", "üßë‚Äçü¶≥", "üë®‚Äçü¶≥", "üë©‚Äçü¶≤", "üßë‚Äçü¶≤", "üë®‚Äçü¶≤", "üßî‚Äç‚ôÄÔ∏è", "üßî", "üßî‚Äç‚ôÇÔ∏è", "üëµ", "üßì", "üë¥"]),
    ("üê±", "Animals", &["üê∂", "üê±", "üê≠", "üêπ", "üê∞", "ü¶ä", "üêª", "üêº", "üêª‚Äç‚ùÑÔ∏è", "üê®", "üêØ", "ü¶Å", "üêÆ", "üê∑", "üê∏", "üêµ", "üêî", "üêß", "üê¶", "üê§", "ü¶Ü", "ü¶Ö", "ü¶â", "ü¶á", "üê∫", "üêó", "üê¥", "ü¶Ñ", "üêù", "üêõ", "ü¶ã", "üêå", "üêû"]),
    ("üçé", "Food", &["üçè", "üçé", "üçê", "üçä", "üçã", "üçå", "üçâ", "üçá", "üçì", "ü´ê", "üçà", "üçí", "üçë", "ü•≠", "üçç", "ü••", "ü•ù", "üçÖ", "üçÜ", "ü•ë", "ü•¶", "ü•¨", "ü•í", "üå∂Ô∏è", "ü´ë", "üåΩ", "ü•ï", "ü´í", "üßÑ", "üßÖ", "ü•î", "üç†"]),
    ("‚öΩ", "Activities", &["‚öΩ", "üèÄ", "üèà", "‚öæ", "ü•é", "üéæ", "üèê", "üèâ", "ü•è", "üé±", "ü™Ä", "üèì", "üè∏", "üèí", "üèë", "ü•ç", "üèè", "ü™É", "ü•Ö", "‚õ≥", "ü™Å", "üèπ", "üé£", "ü§ø", "ü•ä", "ü•ã", "üéΩ", "üõπ", "üõº", "üõ∑", "‚õ∏Ô∏è", "ü•å", "üéø"]),
    ("üöó", "Travel", &["üöó", "üöï", "üöô", "üöå", "üöé", "üèéÔ∏è", "üöì", "üöë", "üöí", "üöê", "üõª", "üöö", "üöõ", "üöú", "üõµ", "üèçÔ∏è", "üõ∫", "üö≤", "üõ¥", "üö®", "üöî", "üöç", "üöò", "üöñ", "‚úàÔ∏è", "üõ´", "üõ¨", "üõ©Ô∏è", "üöÄ", "üõ∏", "üöÅ", "üõ∂", "‚õµ", "üö§"]),
    ("üí°", "Objects", &["‚åö", "üì±", "üì≤", "üíª", "‚å®Ô∏è", "üñ•Ô∏è", "üñ®Ô∏è", "üñ±Ô∏è", "üñ≤Ô∏è", "üíΩ", "üíæ", "üíø", "üìÄ", "üìº", "üì∑", "üì∏", "üìπ", "üé•", "üìΩÔ∏è", "üéûÔ∏è", "üìû", "‚òéÔ∏è", "üìü", "üì†", "üì∫", "üìª", "üéôÔ∏è", "üéöÔ∏è", "üéõÔ∏è", "üß≠", "‚è±Ô∏è", "‚è≤Ô∏è", "‚è∞", "üï∞Ô∏è", "üí°", "üî¶"]),
];

/// Emoji picker widget
pub struct EmojiPicker {
    selected_category: usize,
    search_query: String,
}

impl Default for EmojiPicker {
    fn default() -> Self {
        Self {
            selected_category: 0,
            search_query: String::new(),
        }
    }
}

impl EmojiPicker {
    pub fn new() -> Self {
        Self::default()
    }

    /// Show the emoji picker and return selected emoji if any
    pub fn show(&mut self, ui: &mut egui::Ui) -> Option<String> {
        let mut selected_emoji = None;

        // Search bar
        ui.horizontal(|ui| {
            ui.label("üîç");
            ui.text_edit_singleline(&mut self.search_query);
        });

        ui.add_space(8.0);

        // Category tabs
        ui.horizontal(|ui| {
            for (i, (icon, _, _)) in EMOJI_CATEGORIES.iter().enumerate() {
                let selected = i == self.selected_category;
                if ui.selectable_label(selected, *icon).clicked() {
                    self.selected_category = i;
                }
            }
        });

        ui.separator();

        // Emoji grid
        let emojis = if self.search_query.is_empty() {
            EMOJI_CATEGORIES[self.selected_category].2
        } else {
            // Search across all categories
            // For simplicity, just show current category
            EMOJI_CATEGORIES[self.selected_category].2
        };

        egui::ScrollArea::vertical()
            .max_height(200.0)
            .show(ui, |ui| {
                ui.horizontal_wrapped(|ui| {
                    for emoji in emojis {
                        if ui.button(*emoji).clicked() {
                            selected_emoji = Some(emoji.to_string());
                        }
                    }
                });
            });

        selected_emoji
    }
}
